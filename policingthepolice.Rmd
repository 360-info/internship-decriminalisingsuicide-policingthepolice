---
title: "Policing the police"
author: "Nishtha Arora"
date: "2023-05-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(readr)
library(readxl)
library(tidyverse)
library(lubridate)
```

Potential data sets

# UNODC

```{r}
corruption_UNODC <- read_excel("data/policingthepolice/data_cts_corruption_and_economic_crime.xlsx") |> slice(-c(1,2))
colnames(corruption_UNODC) <- c('Iso3_code','Country','Region', 'Subregion','Indicator','Dimension', 'Category','Sex','Age','Year','Unit of measurement','VALUE','Source') 
```

```{r}
data_clean <- corruption_UNODC |> 
  filter(`Unit of measurement` == "Counts") |> 
  select(Iso3_code, Country, Category, VALUE, Year) |> 
  filter(Category %in% c("Corruption")) |> 
  mutate(VALUE= as.numeric(VALUE)) |> 
  group_by(Country) |> 
  summarise(VALUE= mean(VALUE)) |> 
  arrange(desc(VALUE)) |> 
  head(10)
  
    #mutate(Year= as.Date(as.character(Year), format = "%Y"))

ggplot(data_clean, aes(x=Country, y= VALUE))+
  geom_col( fill="lightblue")+
  theme(legend.position = "none")+
  ggtitle("highest average corruption cases every year")+
  theme_dark()
```

#OWID


Global Perception of corruption by institution, 2013-2017  https://ourworldindata.org/corruption
Percentage of survey respondents who answered that either “Most” or “All” are corrupt.
```{r}
OWID_police <- read_csv("data/policingthepolice/perception-of-corruption-by-institution.csv") |> 
   summarise_if(is.numeric, mean, na.rm = TRUE) |> select(-c(Year))

 ggplot(t_data_OWID, aes(x=rownames(t_data_OWID), y=Count)) +
  geom_col()

t_data_OWID <- data.frame(t(OWID_police)) |> 
  rename(Count = t.OWID_police.) 

plot(rownames(t_data_OWID), t_data_OWIDt$Count)

  ggplot(t_data_OWID, aes(x=reorder(rownames(t_data_OWID), -Count), y=Count, fill=rownames(t_data_OWID) )) +
  geom_col()+
    theme(legend.position = "none")+
     theme(
    axis.text.x = element_text(
      color = "#993333",
      angle = 20,
      size = 10
)
  )+
    ggtitle("Global Perception of corruption by institution, 2013-2017")+
    xlab("Institution")+
    scale_fill_manual(values=c("#C9BE4E",
                             "#478934",
                             "#5CD2FF",
                             "#5C7077",
                             "#C898DC",
                             "#B23F1D",
                             "#C25B7E",
                             "#AE95CA",
                             "#7C213D",
                             "#09A2E5"))
```

# Washington Post/Github

Fatal Encounters-USA
https://www.washingtonpost.com/graphics/investigations/police-shootings-database/
https://github.com/washingtonpost/data-police-shootings/tree/master/v1
```{r}
fatal_police_shootings_data <- read_csv("data/policingthepolice/fatal-police-shootings-data.csv") |> 
  mutate(year=year(date)) |> 
  select(gender, race, city, state, year) |> 
  group_by(year) |> 
  summarise(count=n()) |> 
  ggplot(aes(x=year, y=count))+
  geom_line()
fatal_police_shootings_data
```



# NCRB 

Cases against police-India
https://ncrb.gov.in/en/crime-in-india-table-addtional-table-and-chapter-contents?page=21
```{r}
Table_16A_5_0 <- read_excel("data/policingthepolice/castagainstpolicep/Table 16A.5_0.xlsx") |> 
  slice(-c(1,2,3,4,5, 35, 36, 44, 45, 46,47)) |> 
  add_column(Year = "2018")
colnames(Table_16A_5_0) <- c('S. No.','State/UT','Registered Cases', 'Quashed/ Stayed by Court','Charge-sheeted cases','Final Report Submitted', 'Arrested',' Charge-sheeted police','Cases With-drawn/ Disposed Off','Trials were Completed',' Convicted','Acquitted or Discharged', 'Year') 

Table_16A_5_1 <- read_excel("data/policingthepolice/castagainstpolicep/Table 16A.5_1.xlsx") |> 
  slice(-c(1,2,3,4,5, 35, 36, 44, 45, 46,47)) |> 
  add_column(Year = "2017")
colnames(Table_16A_5_1) <- c('S. No.','State/UT','Registered Cases', 'Quashed/ Stayed by Court','Charge-sheeted cases','Final Report Submitted', 'Arrested',' Charge-sheeted police','Cases With-drawn/ Disposed Off','Trials were Completed',' Convicted','Acquitted or Discharged', 'Year') 

Table_16A_5_2 <- read_excel("data/policingthepolice/castagainstpolicep/Table 16A.5-2.xlsx") |> 
  slice(-c(1,2,3,4,5, 35, 36, 44, 45, 46,47)) |> 
  add_column(Year = "2020")
colnames(Table_16A_5_2) <- c('S. No.','State/UT','Registered Cases', 'Quashed/ Stayed by Court','Charge-sheeted cases','Final Report Submitted', 'Arrested',' Charge-sheeted police','Cases With-drawn/ Disposed Off','Trials were Completed',' Convicted','Acquitted or Discharged', 'Year') 


Table_16A_5 <- read_excel("data/policingthepolice/castagainstpolicep/Table 16A.5.xlsx")|> 
    slice(-c(1,2,3,4,5, 35, 36, 44, 45, 46,47)) |> 
  add_column(Year = "2019")
colnames(Table_16A_5) <- c('S. No.','State/UT','Registered Cases', 'Quashed/ Stayed by Court','Charge-sheeted cases','Final Report Submitted', 'Arrested',' Charge-sheeted police','Cases With-drawn/ Disposed Off','Trials were Completed',' Convicted','Acquitted or Discharged', 'Year') 

options(digits=2)

data_policecases <- rbind(Table_16A_5_0, Table_16A_5_1, Table_16A_5_2, Table_16A_5) |> 
  mutate(Arrested=as.numeric(Arrested),
         `Registered Cases` = as.numeric(`Registered Cases`)) |> 
  select(`State/UT`, `Registered Cases`, Arrested, Year) |> 
  mutate(sum = rowSums(across(where(is.numeric))),
         percentage= (Arrested/sum)*100,
         `State/UT`=trimws(`State/UT`),
         `State/UT`= recode(`State/UT`,
                            "Delhi UT" = "Delhi" )) |> 
  select(-c(sum,`Registered Cases`, Arrested )) |> 
  arrange(desc(percentage)) |>
  filter(Year=="2020")
  
  
  ggplot(data_policecases, aes(x=reorder(`State/UT`, -percentage), y=percentage, fill=Year))+
  geom_col()+
  theme(
    axis.text.x = element_text(
      color = "#993333",
      angle = 45,
      size = 10
))

```



# OWID
https://ourworldindata.org/grapher/trust-in-others-vs-trust-in-police
```{r}
europe_trust_in_police <- read_csv("data/policingthepolice/trust-in-others-vs-trust-in-police.csv") |> 
  na.omit()

ggplot(europe_trust_in_police, aes(y=`GDP per capita, PPP (constant 2017 international $)`, x=`Trust in police (Eurostat (2015))`, colour=Entity))+
  geom_point(size=4)
```


https://data.police.uk/data/open-data/

```{r}
Police_reserves_data_2018 <- read_csv("data/policingthepolice/financial_reserves_data/Police reserves data 2018.csv")
```

https://data.world/stabile-center/ph-drug-war#
```{r}
PH_data <- read_excel("data/policingthepolice/PH data.xlsx") |> 
  filter(`Type of killing` == "Police killing") |> 
  mutate(Date=as.POSIXct(Date, format= "%Y"),
  year=year(Date)) |> 
   select(City, `Type of killing`, year) |> 
  group_by(City, year) |> 
  summarise(count=n())

ggplot(PH_data, aes(x=City, y=count, fill=year))+
  geom_col()
```

Explore:
https://ec.europa.eu/eurostat/web/main/data/database
https://ourworldindata.org/charts

# Reference

Basic question for plotting x axis using row.names. (n.d.). Google Groups. https://groups.google.com/g/ggplot2/c/UkmDYDcRNWc?pli=1

Combine two data frames with the same column names. (n.d.). Stack Overflow. https://stackoverflow.com/questions/20081256/combine-two-data-frames-with-the-same-column-names

Crime in India Table Contents |  National Crime Records Bureau. (n.d.). https://ncrb.gov.in/en/crime-in-india-table-addtional-table-and-chapter-contents?field_date_value%5Bvalue%5D%5Byear%5D=&field_select_table_title_of_crim_value=18&items_per_page=All

Formatting Decimal places in R. (n.d.). Stack Overflow. https://stackoverflow.com/questions/3443687/formatting-decimal-places-in-r

GeeksforGeeks. (2021). Change column name of a given DataFrame in R. GeeksforGeeks. https://www.geeksforgeeks.org/change-column-name-of-a-given-dataframe-in-r/

Plot data in descending order as appears in data frame. (n.d.). Stack Overflow. https://stackoverflow.com/questions/16961921/plot-data-in-descending-order-as-appears-in-data-frame

Sum across multiple columns with dplyr. (n.d.). Stack Overflow. https://stackoverflow.com/questions/28873057/sum-across-multiple-columns-with-dplyr