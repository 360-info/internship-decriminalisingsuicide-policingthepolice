---
title: "De-Criminalizing Suicide:  Visualizations"
author: "Nishtha Arora"
output: html_document
date: "2023-03-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.width=12, fig.height=8)
```

# Visualization 1

## WORLD SUICIDE RATE'S COMPARISON WITH DEVELOPMENT STATUS.

### Data sources 
1.Worldwide suicide rates OWID (filtering from 2000-2019, i.e. 10 years)
https://ourworldindata.org/suicide

2.HDI Data- Values recorded in 2021, rank (2020).
http://hdr.undp.org/en/composite/HDI


```{r libraries}
library(readr)
library(readxl)
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(ggthemes)
library(reshape2)
library(lubridate)
library(ggplot2)
library(RColorBrewer)
library(ggmap)
library(maps)
library(mapproj)
library(maptools)
library(rgeos)
library(themes360info)
```

```{r cleaning}
read_data <- function(x,y,z){
  read_excel("data/InitialA1/HDIstatus.xlsx", rang = x,col_names = FALSE) %>% 
    rename(HDI_rank_2021 = ...1, 
           Country = ...2, 
           HDI_Value = ...3, 
           Life_expectancy = ...5, 
           Expected_years_of_schooling = ...7, 
           Mean_years_of_schooling = ...9, 
           GNI_per_capita = ...11, 
           GNI_rank_minus_HDI_rank = ...13, 
           HDI_rank_2020 = ...15)} %>% 
  select(HDI_rank_2021, Country, HDI_Value,
         Life_expectancy, Expected_years_of_schooling, 
         Mean_years_of_schooling, GNI_per_capita, 
         GNI_rank_minus_HDI_rank, HDI_rank_2020) %>% 
  mutate(y = z )


VERY_HIGH_HUMAN_DEVELOPMENT <- 
  read_data('A9:O74',Degree_of_Human_Development, 'VERY HIGH HUMAN DEVELOPMENT')

HIGH_HUMAN_DEVELOPMENT <- 
  read_data('A76:O128', Degree_of_Human_Development, 'HIGH HUMAN DEVELOPMENT' ) 

MEDIUM_HUMAN_DEVELOPMENT <- 
  read_data('A130:O166', Degree_of_Human_Development, 'MEDIUM HUMAN DEVELOPMENT' ) 

LOW_HUMAN_DEVELOPMENT <- 
  read_data('A168:O200', Degree_of_Human_Development, 'LOW HUMAN DEVELOPMENT' )

HDI <- bind_rows(VERY_HIGH_HUMAN_DEVELOPMENT,HIGH_HUMAN_DEVELOPMENT,MEDIUM_HUMAN_DEVELOPMENT,LOW_HUMAN_DEVELOPMENT)

write_csv(HDI, "data/InitialA1/HDIStatus2.csv")
```

```{r saving_cleaned_data}
data3 <- read_csv("data/InitialA1/HDIStatus2.csv") %>% 
  rename("Entity"= Country)
```

```{r reading data_suicides}
data2 <- read_csv("data/InitialA1/suicide-death-rates.csv")
```

```{r matching_column_names}
# setdiff(data2$Entity, data3$Entity)

change <- data2 %>%
  mutate(Entity = recode(Entity,
    "American Samoa" = "Samoa",
    "Bolivia" = "Bolivia (Plurinational State of)",
    "Brunei"= "Brunei Darussalam",
    "Cape Verde"= "Cabo Verde",
    "Cote d'Ivoire"="CÃ´te d'Ivoire",
    "Democratic Republic of Congo"= "Congo (Democratic Republic of the)",
    "Eswatini"= "Eswatini (Kingdom of)",
    "Iran"= "Iran (Islamic Republic of)",
    "Laos"= "Lao People's Democratic Republic",
    "Micronesia (country)"= "Micronesia (Federated States of)",
    "North Korea"= "Korea (Republic of)",
    "Northern Ireland"= "Ireland",
    "Palestine"= "Palestine, State of",
    "Russia"= "Russian Federation",
    "South Sudan"= "Sudan",
    "Syria"= "Syrian Arab Republic",
    "Timor"= "Timor-Leste",
    "Venezuela"= "Venezuela (Bolivarian Republic of)",
    "Vietnam"= "Viet Nam"
    ))
```

```{r preparing_for_plot}
filtered <- change %>% filter(Year > 1999) %>% 
  group_by(Entity) %>% 
  summarise(avg_rate=mean(`Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)`))

join <- full_join(filtered, data3) %>% 
  arrange(desc(avg_rate)) %>% na.omit() %>% 
  rename(`Development status` = y) %>% 
  mutate(avg_rate= round(avg_rate, digits=2))
```


### Visualization for top 30 countries with the most suicide rates (average), 2000-2019 and their development status.

```{r plot1}
plot1 <- join %>% head(30)
ggplot(plot1, aes(x=reorder(Entity, -avg_rate), y=avg_rate, fill=`Development status`))+
  geom_col()+
geom_text(aes(label = avg_rate), vjust = 2, colour = "white", size=3)+
  theme(legend.position="bottom",
        axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+
  labs(title="Top 30 countries with maximum suicides for 10 years, 2000-2019",
         x=substitute(paste(bold("Country"))),
      y=substitute(paste(bold("Suicide rate per 100,000 people"))))+
  scale_fill_manual(values = c("#A0331C", "#1C56A0", "#4B902F", "#635A61"))+
   theme(plot.title = element_text(face="bold"))
```

# Visualization 2

## CHANGES BEFORE AND AFTER INDIA'S MENTAL HEALTH ACT 2017.

### Data sources
1. WHO
https://www.who.int/data/gho/data/themes/mental-health/suicide-rates

```{r who_data}
who_data <-read_csv("data/InitialA1/data-2.csv") %>% 
  filter(Dim1=="Both sexes") %>% 
  select(Location, Period, FactValueNumeric)
```

### Visualization for India's suicide rates over time.

```{r plot2}
who_data %>% filter(Location=="India") %>% 
ggplot(aes(x=Period, y=FactValueNumeric))+
  geom_line()+
  xlab(NULL)+
  ylab(substitute(paste(bold("Rate per 100,000 people"))))+
  geom_point(color="brown", size=1.5)+
  ggtitle("Time-series for India, 2000-2019")+
 theme_economist()+
   theme(plot.title = element_text(size=14, lineheight=.8))+
  geom_vline(xintercept = 2017, linetype = "dashed")+
scale_color_manual(values=c('Brown','Purple', 'Black'))+
  theme(legend.position = "none")
```

# Visualization 3

## 2019 State/UT-wise India's suicide rate.

### Data sources
1. Registered cases with data.gov
https://data.gov.in/resource/stateut-wise-suicides-registered-during-2019-ministry-home-affairs

2.Spatial data
http://www.diva-gis.org/datadown

```{r reading_region_wise_data_mapfiles}
options(scipen=999)

region_cases_2019 <- read_csv("data/InitialA1/RS_Session_253_A_211.1.csv") %>% 
  filter(str_detect(`State/UT`, "Total ", negate = TRUE)) %>% 
  select(`State/UT`, Total )

df_newid=data.frame(id=c(2,3,4, 5,7,11,12,13,14,15,16,17,18,20, 21,22,23,24,25,26, 28,29,30, 31,32,33,34, 35,36, 1, 6, 8,9,10,19, 27))

join_newid <- cbind(region_cases_2019, df_newid) %>% 
    mutate(id=as.numeric(id))

spatial_state <- readShapeSpatial("data/InitialA1/IND_adm/IND_adm1.shp")
fortify_spatial = fortify(spatial_state, region = "ID_1")

Merge = merge(fortify_spatial, join_newid, by="id", all.x=TRUE)
Map_plot = Merge[order(Merge$order), ]
```

### Map of India showing region wise suicide count in 2019.

```{r plot3}

ggplot() +
  geom_polygon(data = Map_plot,
           	aes(x = long, y = lat, group = group, fill = Total),
      	     color = "black", linewidth = 0.25) +
  coord_map()+
  scale_fill_gradient(name="State/UT", low = 'white', high = 'orange')+
  labs(title="Region-wise 2019 data:India")
```


# Visulaization 4

## Data source
1. WHO- https://www.who.int/data/gho/data/themes/mental-health/suicide-rates

### Countries with outliers in data

```{r outliers_indatacollection}
who_data %>% filter(Location %in% c( "Kiribati", "Central African Republic", "Latvia", "Republic of Korea", "Fiji", "Rwanda", "Poland", "Comoros", "Uzbekistan", "Bosnia and Herzegovina", "Grenada", "Niger", "Cuba", "Equatorial Guinea", "Burkina Faso", "Samoa", "Latvia", "Sao Tome and Principe", "Honduras", "Lebanon", "Maldives", "Bahamas", "Timor-Leste", "Iraq", "Dominican Republic", "Iran (Islamic Republic of)", "Brazil", "Bolivia (Plurinational State of)", "The former Yugoslav Republic of Macedonia", "Portugal", "Belize", "Serbia", "Mali", "Argentina", "United Republic of Tanzania", "Democratic People's Republic of Korea")) %>% 
  ggplot( aes(x=Location, y=FactValueNumeric, fill=Location)) +
    geom_boxplot() +
  theme(legend.position = "none")+
  scale_fill_viridis(discrete = TRUE, alpha=0.6) +
theme(text = element_text(size=8),
        axis.text.x = element_text(angle=45, hjust=1),
      plot.title = element_text(size=14, lineheight=8)) +
  xlab(substitute(paste(bold("Country"))))+
  ylab(substitute(paste(bold("Suicide Rates"))))+
  ggtitle(substitute(paste(bold("Irregularity in Data Collection"))))

```

# Visulaization 5

## Data source
1. WHO- https://www.who.int/data/gho/data/themes/mental-health/suicide-rates

## South Asian countries-Suicide rate trend.

```{r}
filtered <- who_data %>% 
  filter(Location %in% c("India", "Maldives", "Afghanistan", "Nepal", "Bangladesh", "Bhutan", "Sri Lanka", "Pakistan"))

ggplot(filtered, aes(colour=Location, y=FactValueNumeric, x=Period ))+
  geom_line()+
  geom_point()+
  ylab("Suicide rate")+
  ggtitle("South Asian Countries")+
  scale_colour_brewer(type = "seq", palette = "Dark2")+
  theme_classic()
```

