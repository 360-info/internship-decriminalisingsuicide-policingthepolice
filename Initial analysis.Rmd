---
title: "De-Criminalizing Suicide:  Initial Analysis"
author: "Nishtha Arora"
output: html_document
date: "2023-03-19"
---
# Initial Analysis 1

## COMPARISON WITH DEVELOPMENT STATUS. 2008-2019.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.width=12, fig.height=8)
```

### Data sources 
1. Using data from 2008-2019 (12 years), worldwide suicide rates- 
https://ourworldindata.org/suicide

2. Using HDI data for High, Very high and medium development country recognition- http://hdr.undp.org/en/composite/HDI


```{r libraries}
library(readxl)
library(tidyverse)
library(hrbrthemes)
library(ggthemes)
library(lubridate)
library(sf)
# library(gridExtra)
library(rgeos)
```

```{r cleaning}
read_data <- function(range, development_status) {
  read_excel(
    "data/InitialA1/HDIstatus.xlsx", range = range, col_names = FALSE) %>%
    rename(
      HDI_rank_2021 = ...1,
      Country = ...2,
      HDI_Value = ...3,
      Life_expectancy = ...5,
      Expected_years_of_schooling = ...7,
      Mean_years_of_schooling = ...9,
      GNI_per_capita = ...11,
      GNI_rank_minus_HDI_rank = ...13,
      HDI_rank_2020 = ...15
    ) %>%
  select(
    HDI_rank_2021, Country, HDI_Value,
    Life_expectancy, Expected_years_of_schooling,
    Mean_years_of_schooling, GNI_per_capita,
    GNI_rank_minus_HDI_rank, HDI_rank_2020
  ) %>%
  mutate(Degree_of_Human_Development = development_status)
}

very_high_hdi <-
  read_data("A9:O74", "VERY HIGH HUMAN DEVELOPMENT")

high_hdi <-
  read_data("A76:O128", "HIGH HUMAN DEVELOPMENT")

medium_hdi <-
  read_data("A130:O166", "MEDIUM HUMAN DEVELOPMENT")

low_hdi <-
  read_data("A168:O200", "LOW HUMAN DEVELOPMENT")

hdi <- bind_rows(very_high_hdi, high_hdi, medium_hdi, low_hdi)

write_csv(hdi, "data/InitialA1/HDIStatus2.csv")
```

```{r loadtidiedhdidata}
tidied_hdi_data <- read_csv("data/InitialA1/HDIStatus2.csv") %>%
  rename("Entity" = Country)
```

```{r suicideratedata}
suicide_rates <- read_csv("data/InitialA1/suicide-death-rates.csv")
```

```{r}
# setdiff(data2$Entity, data3$Entity)

# rename countries to align with other dataset
change <- suicide_rates %>%
  mutate(Entity = recode(Entity,
    "American Samoa" = "Samoa",
    "Bolivia" = "Bolivia (Plurinational State of)",
    "Brunei" = "Brunei Darussalam",
    "Cape Verde" = "Cabo Verde",
    "Cote d'Ivoire" = "CÃ´te d'Ivoire",
    "Democratic Republic of Congo" = "Congo (Democratic Republic of the)",
    "Eswatini" = "Eswatini (Kingdom of)",
    "Iran" = "Iran (Islamic Republic of)",
    "Laos" = "Lao People's Democratic Republic",
    "Micronesia (country)" = "Micronesia (Federated States of)",
    "North Korea" = "Korea (Republic of)",
    "Northern Ireland" = "Ireland",
    "Palestine" = "Palestine, State of",
    "Russia" = "Russian Federation",
    "South Sudan" = "Sudan",
    "Syria" = "Syrian Arab Republic",
    "Timor" = "Timor-Leste",
    "Venezuela" = "Venezuela (Bolivarian Republic of)",
    "Vietnam" = "Viet Nam"
  ))
```

```{r}
# calculate the average death rate over 2008 to latest
filtered <- change %>%
  filter(Year > 2007) %>%
  group_by(Entity) %>%
  summarise(avg_rate = mean(
    `Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)`))
```

```{r}
join <- full_join(filtered, tidied_hdi_data) %>%
  arrange(desc(avg_rate)) %>%
  na.omit() %>%
  rename(`Development status` = Degree_of_Human_Development) %>%
  mutate(avg_rate = round(avg_rate, digits = 2))
```

### Visualization for top 30 countries with maximum suicide rates

```{r}
plot1 <- join %>% head(30)
ggplot(plot1,
  aes(x = reorder(Entity, -avg_rate), y = avg_rate,
    fill = `Development status`)) +
  geom_col() +
  geom_text(aes(label = avg_rate), vjust = 2, colour = "white", size = 3) +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 1)
  ) +
  labs(
    title = "Top 30 countries by average suicide rate (2008-2019)",
    x = substitute(paste(bold("Country"))),
    y = substitute(paste(bold("Suicide rate per 100,000 people")))
  ) +
  scale_fill_manual(
    values = c("#A0331C", "#1C56A0", "#4B902F", "#635A61")) +
  theme(plot.title = element_text(face = "bold"))
```

# Initial Analysis 2

## India's Mental Health Act 2017

### Suicide Rates & reported mental health issues before and after 2017

Data source: https://data.worldbank.org/indicator/SH.STA.SUIC.P5?locations=IN
https://ourworldindata.org/mental-health

```{r}
india_suicide_rates <- suicide_rates %>%
  filter(Entity == "India") %>%
  filter(Year > 1999)

india_mental_substence_disorder_rates <- read_csv("data/InitialA1/share-with-mental-and-substance-disorders.csv") %>%
  filter(Entity == "India") %>%
  filter(Year > 1999)

india_all_rates <-
  full_join(
    india_suicide_rates,
    india_mental_substence_disorder_rates,
    by = c("Year", "Code", "Entity")) %>%
  select(-c(Entity, Code))

india_all_rates_long <-
  pivot_longer(india_all_rates, cols = -Year, names_to = "variable") %>%
  mutate(variable = recode(variable,
    "Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)" =
      "Suicide",
    "Prevalence - Mental disorders - Sex: Both - Age: Age-standardized (Percent)" =
      "Mental Health disorder"
  ))
```


```{r}
ggplot(india_all_rates_long, aes(x = Year, y = value, col = variable)) +
  geom_line() +
  geom_point(color = "brown", size = 1.5) +
  geom_vline(xintercept = 2017, linetype = "dashed") +
  geom_text(aes(x = 2005, y = 18.5, label = "Suicide Rate", colour = "Black")) +
  geom_text(aes(x = 2010, y = 14.2, label = "Mental Disorder rate", colour = "Black")) +
  scale_x_continuous(breaks = seq(from = 2000, to = 2019, by = 1)) +
  scale_color_manual(values = c("brown", "purple", "black")) +
  labs(
    x = Year,
    y = "Rate per 100,000 people",
    title = "Time-series for India, 2000-2019"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    axis.title = element_text(face = "bold"),
    plot.title = element_text(size = 14, lineheight = .8)
    )
```

Data sources:

* https://data.gov.in/catalog/stateut-wise-distribution-suicides-causes
* http://www.diva-gis.org/datadown

# Initial Analysis 3

## 2014 statewise and Union terr India suicide rate

```{r}
india_regional_2014 <-
  read_excel("data/map/datafile.xls") %>%
  select(`States/UTs`, `Grand Total`) %>%
  group_by(`States/UTs`) %>%
  summarise(Average_suicide_rate = mean(`Grand Total`)) %>%
  filter(str_detect(`States/UTs`, "Total ", negate = TRUE)) %>%
  mutate(id = seq.int(nrow(.)))
```

```{r}
states_shape_sf <- read_sf("data/map/IND_adm/IND_adm1.shp")
states_merged <- inner_join(states_shape_sf, india_regional_2014,
  by = c("ID_1" = "id"))
```

```{r}
ggplot() +
  geom_sf(
    aes(fill = Average_suicide_rate),
    data = states_merged,
    color = "black",
    linewidth = 0.25
  ) +
  coord_sf() +
  scale_fill_gradient(name = "Suicide Rate", low = "white", high = "red") +
  labs(title = "Region-wise 2014 data:India") +
# geom_text(data=cnames, aes(long, lat, label = id), size=3, fontface="bold")
```

# Initial Analysis 5

Data from WHO - https://www.who.int/data/gho/data/themes/mental-health/suicide-rates

```{r}
data <- data <- read_csv("data/Article-wise/data.csv") %>% 
  select(SpatialDimValueCode, Location, Period, Dim1, FactValueNumeric) %>% 
  filter(Dim1 == "Both sexes") 
```

```{r}
# names <- unique(data$Location)
# view(names)
# 
#Identifying countries with data gaps
# data %>% 
#   ggplot( aes(x=Location, y=FactValueNumeric, fill=Location)) +
#     geom_boxplot()
```


## Countries with outliers in data

```{r}
data %>%  filter(Location %in% c( "Kiribati", "Central African Republic", "Latvia", "Republic of Korea", "Fiji", "Rwanda", "Poland", "Comoros", "Uzbekistan", "Bosnia and Herzegovina", "Grenada", "Niger", "Cuba", "Equatorial Guinea", "Burkina Faso", "Samoa", "Latvia", "Sao Tome and Principe", "Honduras", "Lebanon", "Maldives", "Bahamas", "Timor-Leste", "Iraq", "Dominican Republic", "Iran (Islamic Republic of)", "Brazil", "Bolivia (Plurinational State of)", "The former Yugoslav Republic of Macedonia", "Portugal", "Belize", "Serbia", "Mali", "Argentina", "United Republic of Tanzania", "Democratic People's Republic of Korea")) %>% 
  ggplot( aes(x=Location, y=FactValueNumeric, fill=Location)) +
    geom_boxplot() +
  theme(legend.position = "none")+
  scale_fill_viridis(discrete = TRUE, alpha=0.6) +
theme(text = element_text(size=8),
        axis.text.x = element_text(angle=45, hjust=1),
      plot.title = element_text(size=14, lineheight=8)) +
  xlab(substitute(paste(bold("Country"))))+
  ylab(substitute(paste(bold("Suicide Rates"))))+
  ggtitle(substitute(paste(bold("Irregularity in Data Collection"))))

```

# Suicide prevention in Bangladesh: The current state and the way forward

```{r}
Bangladesh <- data %>% filter(Location == "Bangladesh")
ggplot(Bangladesh, aes(x=Period, y=FactValueNumeric))+
  geom_line(color="steelblue")+
  geom_point()+
  ylab("Suicide Rate")+
  ggtitle("Bangladesh")+
theme_classic()

```

Suicides started increasin from 2016

In 2016, the government of Bangladesh introduced a pilot project to strengthen the civil registration and vital statistics system and generate cause of death data in Kaliganj Upazila. Community-based health workers were trained to notify births and deaths to the civil registrar, and to conduct verbal autopsy interviews with family members of a deceased person

source- https://pubmed.ncbi.nlm.nih.gov/31474777/

# Initial Analysis 6

## Visualization for South Asian countries

```{r}
filtered <- data %>% 
  filter(Location %in% c("India", "Maldives", "Afghanistan", "Nepal", "Bangladesh", "Bhutan", "Sri Lanka", "Pakistan"))

ggplot(filtered, aes(colour=Location, y=FactValueNumeric, x=Period ))+
  geom_line()+
  geom_point()+
  ylab("Suicide rate")+
  ggtitle("South Asian Countries")+
  scale_colour_brewer(type = "seq", palette = "Dark2")+
  theme_classic()
```

```{r}
article3 <- filtered %>% 
  filter(Location== "Pakistan")

ggplot(article3, aes(colour=Location, y=FactValueNumeric, x=Period ))+
  geom_line()
```

# Initial Analysis 6

## Countries where suicide is illegal

```{r}
illegal <- data %>% 
  filter(Location %in% c("Bahamas", "Bangladesh", "Guyana", "Ghana", "Kenya", "Malawi", "Malaysia", "Myanmar", "Nigeria", "Pakistan", "Papua New Guinea", "Qatar", "Saint Lucia", "Somalia", "South Sudan", "Sudan", "Tanzania", "Tonga", "Uganda", "Brunei"))

ggplot(illegal, aes(colour=Location, y=FactValueNumeric, x=Period ))+
  geom_line()
```








